<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Writing Practice</title>
    <style>
        /* Modern System Variables */
        :root {
            --bg: #f5f5f7; /* Apple-style light gray */
            --card-bg: #ffffff;
            --accent: #0071e3; /* Modern Blue */
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --error: #ff3b30;
            --success: #34c759;
            --border: #d2d2d7;
            --radius: 12px;
        }

        /* Responsive & Native-feel Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased; /* Better rendering on Mac */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-primary);
            padding: 40px 20px;
            line-height: 1.5;
        }

        .container {
            max-width: 800px;
            margin: auto;
        }

        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Slot Styling */
        .slot-box {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            transition: transform 0.2s ease;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .task-type {
            background: #e8f2ff;
            color: var(--accent);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .timer-box {
            font-variant-numeric: tabular-nums; /* Prevents text jumping while timing */
            font-weight: 600;
            color: var(--error);
        }

        .prompt {
            font-size: 1.05rem;
            color: #424245;
            margin-bottom: 20px;
            padding: 15px;
            background: #fbfbfd;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        textarea {
            width: 100%;
            height: 250px;
            padding: 20px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            outline: none;
            transition: border-color 0.2s;
        }

        textarea:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .stats {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Buttons */
        .btn {
            background: var(--text-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 15px;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn-reload {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-primary);
            margin: 40px auto;
            display: block;
        }

        /* Feedback Area */
        .feedback {
            display: none;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px dashed var(--border);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .vocab-tag {
            display: inline-block;
            background: #f2f2f7;
            padding: 4px 10px;
            border-radius: 6px;
            margin: 4px;
            font-size: 0.8rem;
            color: #3a3a3c;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Writing Simulator</h1>
        <p class="subtitle">IELTS General Training • Task 1 & 2</p>
    </header>
    
    <div id="test-area"></div>

    <button class="btn btn-reload" onclick="location.reload()">Generate New Prompts</button>
</div>

<script>
    const writingPool = [
        {
            type: "Task 1: Letter",
            time: 20,
            prompt: "You recently stayed at a hotel and were unhappy with the service. Write a letter to the hotel manager. In your letter: <br>• Describe the details of your stay<br>• Explain why you were dissatisfied<br>• Say what action you want the manager to take.",
            answer: "Dear Sir or Madam, I am writing to express my profound dissatisfaction regarding my recent stay at your establishment from October 5th to 7th...",
            vocab: ["Establishment", "Profound dissatisfaction", "Inadequate", "Rectify the situation"]
        },
        {
            type: "Task 2: Essay",
            time: 40,
            prompt: "Some people believe that it is best to accept a bad situation, such as an unsatisfactory job or shortage of money. Others argue that it is better to try and improve such situations. Discuss both views and give your opinion.",
            answer: "In the modern era, the debate over whether to succumb to unfavorable circumstances or actively seek improvement remains contentious...",
            vocab: ["Succumb", "Unfavorable circumstances", "Contentious", "Proactive approach", "Socio-economic mobility"]
        }
    ];

    let activeTimers = {};

    function updateStats(id) {
        const text = document.getElementById(`text-${id}`).value;
        const words = text.trim() ? text.trim().split(/\s+/).length : 0;
        document.getElementById(`count-${id}`).innerText = `${words} words`;
    }

    function startTimer(id, minutes) {
        if (activeTimers[id]) return;
        
        let totalSeconds = minutes * 60;
        activeTimers[id] = setInterval(() => {
            totalSeconds--;
            let m = Math.floor(totalSeconds / 60);
            let s = totalSeconds % 60;
            
            document.getElementById(`timer-${id}`).innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
            
            if (totalSeconds <= 0) {
                clearInterval(activeTimers[id]);
                lockSlot(id);
            }
        }, 1000);
    }

    function lockSlot(id) {
        clearInterval(activeTimers[id]);
        document.getElementById(`text-${id}`).disabled = true;
        document.getElementById(`btn-${id}`).style.display = 'none';
        document.getElementById(`feedback-${id}`).style.display = 'block';
    }

    function init() {
        const area = document.getElementById('test-area');
        // Generates 40 items
        for (let i = 0; i < 40; i++) {
            const data = writingPool[i % 2]; 
            const slot = document.createElement('div');
            slot.className = 'slot-box';
            slot.innerHTML = `
                <div class="task-header">
                    <span class="task-type">${data.type}</span>
                    <div class="timer-box" id="timer-${i}">${data.time}:00</div>
                </div>
                <div class="prompt">${data.prompt}</div>
                <textarea id="text-${i}" 
                    onfocus="startTimer(${i}, ${data.time})" 
                    oninput="updateStats(${i})" 
                    placeholder="Type your response here..."></textarea>
                <div class="stats">
                    <span id="count-${i}">0 words</span>
                    <span>Goal: ${data.time === 20 ? '150+' : '250+'} words</span>
                </div>
                <button class="btn" id="btn-${i}" onclick="lockSlot(${i})">Submit Response</button>
                <div class="feedback" id="feedback-${i}">
                    <h4 style="margin-bottom:10px; font-size:0.9rem;">Model Band 9 Extract</h4>
                    <p style="font-size:0.95rem; color:#424245; margin-bottom:15px;">${data.answer}</p>
                    <h4 style="margin-bottom:10px; font-size:0.9rem;">Vocabulary to use</h4>
                    ${data.vocab.map(v => `<span class="vocab-tag">${v}</span>`).join('')}
                </div>
            `;
            area.appendChild(slot);
        }
    }

    window.onload = init;
</script>
</body>
</html>
